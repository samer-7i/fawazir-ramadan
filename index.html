<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Remy ğŸ®</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --bg: #0a1120; --card: #162136; --blue: #38bdf8; --text: #ffffff; }
        body { margin: 0; padding: 20px; background: var(--bg); color: var(--text); font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ø§Ù„Ø§Ø³Ù… + Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†) */
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); display: flex; justify-content: center; align-items: center; z-index: 2000; }
        .login-card { background: var(--card); padding: 30px; border-radius: 25px; border: 2px solid var(--blue); max-width: 400px; width: 85%; text-align: center; box-shadow: 0 0 20px rgba(56, 189, 248, 0.2); }
        
        .logo { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--blue); margin-bottom: 15px; }
        input { width: 90%; padding: 15px; border-radius: 12px; border: 1px solid var(--blue); background: #0a1120; color: white; text-align: center; font-size: 1.1em; margin: 15px 0; outline: none; }
        input:focus { box-shadow: 0 0 10px var(--blue); }

        .rules-mini { text-align: right; font-size: 0.85em; color: #cbd5e1; margin-bottom: 20px; background: rgba(255,255,255,0.03); padding: 10px; border-radius: 10px; }

        /* Ø§Ù„ÙƒØ±Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-card { background: var(--card); padding: 25px; border-radius: 20px; border: 1px solid rgba(56, 189, 248, 0.2); max-width: 500px; width: 100%; display: none; text-align: center; }
        .user-info { display: flex; justify-content: space-between; background: rgba(255,255,255,0.05); padding: 10px 15px; border-radius: 12px; margin-bottom: 20px; font-weight: bold; border: 1px solid rgba(56, 189, 248, 0.1); }
        
        .q-text { font-size: 1.4em; font-weight: bold; margin-bottom: 20px; color: var(--blue); }
        .opt-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 1px solid var(--blue); background: rgba(56, 189, 248, 0.05); color: white; border-radius: 12px; cursor: pointer; font-size: 1.1em; font-weight: bold; transition: 0.2s; }
        .opt-btn:hover { background: var(--blue); color: var(--bg); }
        
        .btn-start { background: var(--blue); color: var(--bg); border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; font-size: 1.1em; }
        #waiting-msg { text-align: center; display: none; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-card">
            <img src="logo.png" class="logo" onerror="this.src='https://i.ibb.co/ZzYy6y6/remy-logo.png'">
            <h2 style="color: var(--blue); margin-top: 0;">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Remy ğŸ®</h2>
            
            <input type="text" id="username-input" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ ÙÙŠ Ø¬Ø§ÙƒÙˆ Ù‡Ù†Ø§...">
            
            <div class="rules-mini">
                <p style="margin: 0 0 5px 0; font-weight: bold; color: var(--blue);">ğŸ“œ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø³Ø±ÙŠØ¹Ø©:</p>
                â€¢ <li>âœ… Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ ÙƒÙ„ ÙØ²ÙˆØ±Ø©.</li>
                <li>âœ… Ø£Ø³Ø±Ø¹ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù‚Ø§Ø·..</li>
                <li>âœ… ÙŠØªÙ… ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§ Ø¨Ø¹Ø¯ Ø±Ù…Ø¶Ø§Ù† Ø¹Ù„Ù‰ Ø£ÙˆÙ„ 5 ÙØ§Ø¦Ø²ÙŠÙ† ÙÙ‚Ø·.</li>
                <li>âœ… ÙŠÙ…Ù†Ø¹ Ø§Ù„ØºØ´ Ø¨Ø¬Ù…ÙŠØ¹ Ø£Ø´ÙƒØ§Ù„Ù‡ØŒ ÙˆÙÙŠ Ø­Ø§Ù„ Ø«Ø¨ÙˆØªÙ‡ ÙŠØªÙ… Ø§Ù„Ø§Ø³ØªØ¨Ø¹Ø§Ø¯.</li>
               <li>âœ… ÙŠÙ…Ù†Ø¹ ØªØºÙŠÙŠØ± Ø§Ù„Ù…ØªØµÙØ­ Ø£Ùˆ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ù† Ù…ØªØµÙØ­ Ø®ÙÙŠØ› ÙˆÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© Ù„Ù† ØªÙØ­ØªØ³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·.</li>
                <li>âœ… Ø¨Ù…Ø¬Ø±Ø¯ Ù‚Ø±Ø§Ø¡Ø© Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø±ÙˆØ·ØŒ ÙŠØ¹ØªØ¨Ø± Ø§Ù„Ù…ØªØ³Ø§Ø¨Ù‚ Ù…ÙˆØ§ÙÙ‚Ù‹Ø§ Ø¹Ù„ÙŠÙ‡Ø§.</li> 
                <li>âœ… Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø¹ Remy!</li><br>
                â€¢ 
            </div>

            <button class="btn-start" onclick="joinQuiz()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© âœ…</button>
        </div>
    </div>

    <div id="waiting-msg">
        <img src="logo.png" class="logo" onerror="this.src='https://i.ibb.co/ZzYy6y6/remy-logo.png'">
        <h3>Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù‚Ø§Ø¯Ù… Ù…Ù† Remy... âŒ›</h3>
        <p style="color: #64748b;">Ø¬Ù‡Ø² Ù†ÙØ³Ùƒ ÙŠØ§ Ø¨Ø·Ù„!</p>
    </div>

    <div id="quiz-container" class="main-card">
        <div class="user-info">
            <span id="display-name"></span>
            <span style="color:var(--blue)">Ù†Ù‚Ø§Ø·ÙŠ: <span id="my-points">0</span> Ù†</span>
        </div>
        <div id="question-text" class="q-text"></div>
        <div id="options-container"></div>
        <div id="status-msg" style="margin-top: 15px; font-weight: bold;"></div>
    </div>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
        const config = {
            apiKey: "AIzaSyBxqfLt3o3JWy_vwnpwSQPIVdtEDGoYB6k",
            authDomain: "fawazir-jaco.firebaseapp.com",
            databaseURL: "https://fawazir-jaco-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "fawazir-jaco",
            storageBucket: "fawazir-jaco.firebasestorage.app",
            messagingSenderId: "862747657100",
            appId: "1:862747657100:web:d52ecee9373a5e33fd8ca9"
        };
        firebase.initializeApp(config);
        const db = firebase.database();

        const myQuestions = [
            { q: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø°ÙŠ Ù„ÙÙ‚Ø¨ Ø¨ÙƒÙ„ÙŠÙ… Ø§Ù„Ù„Ù‡ØŸ", options: ["Ø¹ÙŠØ³Ù‰", "Ù…ÙˆØ³Ù‰", "Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…"], correct: 1 },
            { q: "Ù…Ø§ Ù‡ÙŠ Ø£Ø·ÙˆÙ„ Ø³ÙˆØ±Ø© ÙÙŠ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø§Ù„ÙƒØ±ÙŠÙ…ØŸ", options: ["Ø§Ù„Ø¨Ù‚Ø±Ø©", "Ø§Ù„Ù†Ø³Ø§Ø¡", "Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†"], correct: 0 },
            { q: "Ø£ÙƒÙ…Ù„ Ø§Ù„Ù…Ø«Ù„: Ø§Ù„Ù‚Ø±Ø¯ ÙÙŠ Ø¹ÙŠÙ† Ø£Ù…Ù‡", options: ["Ø­ØµØ§Ù†", "ÙÙŠÙ„", "ØºØ²Ø§Ù„"], correct: 2 }
        ];

        let userName = "";
        let currentQIdx = -1;

        function joinQuiz() {
            const input = document.getElementById("username-input").value.trim();
            if (input === "") return alert("ÙŠØ§ Ø¨Ø·Ù„ØŒ Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ø£ÙˆÙ„Ø§Ù‹!");
            
            userName = input;
            document.getElementById("login-overlay").style.display = "none";
            document.getElementById("display-name").innerText = userName;
            
            startListening();
        }

        function startListening() {
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø´Ø®ØµÙŠØ©
            db.ref('totalPoints/' + userName).on('value', s => {
                document.getElementById("my-points").innerText = s.val() || 0;
            });

            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
            db.ref('currentQuestion').on('value', snap => {
                const idx = snap.val();
                currentQIdx = idx;
                const quizBox = document.getElementById("quiz-container");
                const waitBox = document.getElementById("waiting-msg");

                if (idx === -1 || idx === null) {
                    quizBox.style.display = "none";
                    waitBox.style.display = "block";
                } else {
                    waitBox.style.display = "none";
                    quizBox.style.display = "block";
                    showQ(idx);
                }
            });
        }

        function showQ(idx) {
            const data = myQuestions[idx];
            if(!data) return;
            document.getElementById("question-text").innerText = data.q;
            const btnBox = document.getElementById("options-container");
            btnBox.innerHTML = "";
            document.getElementById("status-msg").innerText = "";
            
            data.options.forEach((opt, i) => {
                const b = document.createElement("button");
                b.className = "opt-btn";
                b.innerText = opt;
                b.onclick = () => checkAns(i);
                btnBox.appendChild(b);
            });
        }

        function checkAns(choice) {
            const btns = document.querySelectorAll(".opt-btn");
            btns.forEach(b => b.disabled = true); // Ù…Ù†Ø¹ ØªØºÙŠÙŠØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            const status = document.getElementById("status-msg");

            if(choice === myQuestions[currentQIdx].correct) {
                status.innerText = "Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! ğŸ‰"; status.style.color = "#10b981";
                // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙØ§Ø¦Ø² Ù„Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
                db.ref('winners/' + currentQIdx).push({ name: userName, timestamp: firebase.database.ServerValue.TIMESTAMP });
                db.ref('totalPoints/' + userName).transaction(p => (p || 0) + 1);
            } else {
                status.innerText = "Ø®Ø·Ø£ âŒ Ø­Ø¸Ø§Ù‹ Ø£ÙˆÙØ±"; status.style.color = "#e94560";
            }
        }
    </script>
</body>
</html>

