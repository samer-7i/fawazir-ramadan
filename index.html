<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³Ø§Ø¨Ù‚Ø© Remy ğŸ®</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --bg: #0a1120; --card: #162136; --blue: #38bdf8; --text: #ffffff; }
        body { margin: 0; padding: 20px; background: var(--bg); color: var(--text); font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; }
        
        /* Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆØ§Ù„Ø§Ø³Ù…) */
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); display: flex; justify-content: center; align-items: center; z-index: 2000; }
        .setup-card { background: var(--card); padding: 30px; border-radius: 25px; border: 2px solid var(--blue); max-width: 400px; width: 85%; text-align: center; }
        
        .logo { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--blue); margin-bottom: 15px; }
        input { width: 90%; padding: 15px; border-radius: 12px; border: 1px solid var(--blue); background: #0a1120; color: white; text-align: center; font-size: 1.1em; margin-bottom: 20px; }
        
        /* Ø§Ù„ÙƒØ±Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-card { background: var(--card); padding: 25px; border-radius: 20px; border: 1px solid rgba(56, 189, 248, 0.2); max-width: 500px; width: 100%; display: none; text-align: center; }
        .user-info { display: flex; justify-content: space-between; background: rgba(255,255,255,0.05); padding: 10px 15px; border-radius: 12px; margin-bottom: 20px; font-weight: bold; border: 1px solid rgba(56, 189, 248, 0.1); }
        
        .opt-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 1px solid var(--blue); background: rgba(56, 189, 248, 0.05); color: white; border-radius: 12px; cursor: pointer; font-size: 1.1em; font-weight: bold; }
        .btn-action { background: var(--blue); color: var(--bg); border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

    <div id="setup-overlay" class="overlay">
        <div class="setup-card" id="rules-step">
            <img src="logo.png" class="logo" onerror="this.src='https://i.ibb.co/ZzYy6y6/remy-logo.png'">
            <h2 style="color: var(--blue);">ğŸ“œ Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†</h2>
            <p>1. Ø§Ù„Ø³Ø±Ø¹Ø© Ù‡ÙŠ Ø§Ù„Ù…ÙØªØ§Ø­ âš¡<br>2. Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© = 1 Ù†Ù‚Ø·Ø© ğŸ†</p>
            <button class="btn-action" onclick="showNameStep()">Ù…ÙˆØ§ÙÙ‚ØŒ Ø§Ù„ØªØ§Ù„ÙŠ âœ…</button>
        </div>

        <div class="setup-card" id="name-step" style="display:none;">
            <h2 style="color: var(--blue);">Ø¨Ø·Ù„ Ø¬Ø¯ÙŠØ¯ØŸ ğŸ®</h2>
            <p>Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù„Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠ:</p>
            <input type="text" id="username-input" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§...">
            <button class="btn-action" onclick="startApp()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø© ğŸš€</button>
        </div>
    </div>

    <div id="waiting-msg" style="display:none; text-align:center;">
        <img src="logo.png" class="logo" onerror="this.src='https://i.ibb.co/ZzYy6y6/remy-logo.png'">
        <h3>Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø³Ø¤Ø§Ù„... âŒ›</h3>
    </div>

    <div id="quiz-container" class="main-card">
        <div class="user-info">
            <span id="display-name"></span>
            <span style="color:var(--blue)">Ù†Ù‚Ø§Ø·ÙŠ: <span id="my-points">0</span></span>
        </div>
        <div id="question-text" style="font-size:1.4em; margin-bottom:20px; color:var(--blue)"></div>
        <div id="options-container"></div>
    </div>

    <script>
        const config = { /* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ */ };
        firebase.initializeApp(config);
        const db = firebase.database();

        let userName = "";

        function showNameStep() {
            document.getElementById('rules-step').style.display = 'none';
            document.getElementById('name-step').style.display = 'block';
        }

        function startApp() {
            const input = document.getElementById('username-input').value.trim();
            if (input === "") return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø§Ø³Ù…Ùƒ!");
            
            userName = input;
            document.getElementById("setup-overlay").style.display = "none";
            document.getElementById("display-name").innerText = userName;
            
            // Ø¨Ø¯Ø¡ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            initFirebaseListeners();
        }

        function initFirebaseListeners() {
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù†Ù‚Ø§Ø·
            db.ref('totalPoints/' + userName).on('value', s => {
                document.getElementById("my-points").innerText = s.val() || 0;
            });

            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ
            db.ref('currentQuestion').on('value', snap => {
                const idx = snap.val();
                const quizBox = document.getElementById("quiz-container");
                const waitBox = document.getElementById("waiting-msg");
                if (idx === -1 || idx === null) {
                    quizBox.style.display = "none"; waitBox.style.display = "block";
                } else {
                    waitBox.style.display = "none"; quizBox.style.display = "block";
                    // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ (showQ) ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚
                }
            });
        }
    </script>
</body>
</html>
